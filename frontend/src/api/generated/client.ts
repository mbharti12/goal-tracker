// Generated by scripts/generate-api.mjs. Do not edit manually.

import type { paths } from "./schema";
import { apiRequest } from "../client";

type HttpMethod = "get" | "post" | "put" | "delete" | "patch";

type Operation<Path extends keyof paths, Method extends HttpMethod> = Method extends keyof paths[Path]
  ? paths[Path][Method]
  : never;

type JsonResponse<Response> = Response extends { content: infer Content }
  ? Content extends { "application/json": infer Body }
    ? Body
    : Content extends { "text/plain": infer Body }
      ? Body
      : unknown
  : unknown;

type SuccessResponse<Responses> = 200 extends keyof Responses
  ? Responses[200]
  : 201 extends keyof Responses
    ? Responses[201]
    : 202 extends keyof Responses
      ? Responses[202]
      : 204 extends keyof Responses
        ? Responses[204]
        : "default" extends keyof Responses
          ? Responses["default"]
          : unknown;

export type ApiRequestBody<Path extends keyof paths, Method extends HttpMethod> = Operation<
  Path,
  Method
> extends { requestBody: { content: { "application/json": infer Body } } }
  ? Body
  : undefined;

export type ApiResponse<Path extends keyof paths, Method extends HttpMethod> = Operation<
  Path,
  Method
> extends { responses: infer Responses }
  ? JsonResponse<SuccessResponse<Responses>>
  : unknown;

export async function request<Path extends keyof paths, Method extends HttpMethod>(
  path: Path,
  method: Method,
  options: {
    body?: ApiRequestBody<Path, Method>;
  } & Omit<RequestInit, "body" | "method"> = {},
): Promise<ApiResponse<Path, Method>> {
  const { body, ...init } = options;
  return apiRequest<ApiResponse<Path, Method>>(path as string, {
    ...init,
    method: method.toUpperCase(),
    body,
  });
}
